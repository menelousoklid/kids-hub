<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#111111" />
  <title>Boyama</title>
  <style>
    :root{
      --bg:#0f1220; --panel:#171a2b; --text:#f2f5ff; --muted:#aab3d6;
      --shadow: 0 10px 30px rgba(0,0,0,.35); --radius:18px;
    }
    *{box-sizing:border-box;}
    html,body{height:100%;}
    body{
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 900px at 20% 10%, #1a1f43 0%, var(--bg) 55%, #0b0d18 100%);
      color:var(--text);
      overflow:hidden;
      -webkit-tap-highlight-color: transparent;
      touch-action:none; /* √ßizimde scroll/zoom olmasƒ±n */
    }
    .app{height:100%; display:flex; flex-direction:column; padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);}
    header{
      padding:14px; display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .title{display:flex; align-items:center; gap:10px; min-width:0;}
    .logo{
      width:42px;height:42px;border-radius:14px;
      background: linear-gradient(135deg, #ffcc66, #ff6bd6 45%, #6b8bff);
      box-shadow: var(--shadow);
      display:grid; place-items:center; font-size:22px;
    }
    h1{margin:0; font-size:16px;}
    .sub{margin:2px 0 0; color:var(--muted); font-size:12px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
    .actions{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;}
    .btn{
      appearance:none; border:0; cursor:pointer;
      border-radius:999px; padding:10px 14px;
      font-weight:800; font-size:13px; color:var(--text);
      background: linear-gradient(135deg, #6b8bff, #42e2ff);
      box-shadow: var(--shadow);
      user-select:none;
    }
    .btn.secondary{background: rgba(255,255,255,.10); border:1px solid rgba(255,255,255,.16);}
    .btn:active{transform: translateY(1px) scale(.99);}

    main{flex:1; padding: 0 14px 14px; min-height:0; display:flex;}
    .panel{
      width:100%; max-width:980px; margin:0 auto;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 12px;
      display:flex; flex-direction:column; gap:12px;
      min-height:0;
    }

    .toolbar{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
      padding: 6px 6px 0;
    }
    .group{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
    .swatches{display:flex; gap:8px; align-items:center; flex-wrap:wrap;}
    .swatch{
      width:38px; height:38px; border-radius:14px;
      border: 2px solid rgba(255,255,255,.25);
      box-shadow: 0 10px 18px rgba(0,0,0,.22);
      cursor:pointer;
    }
    .swatch[aria-pressed="true"]{ outline: 3px solid rgba(255,255,255,.35); outline-offset: 2px; }

    .slider{
      display:flex; align-items:center; gap:10px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      padding:10px 12px;
      border-radius:999px;
      font-weight:800; font-size:13px;
      user-select:none;
    }
    input[type="range"]{ width: 140px; }

    .canvasWrap{
      flex:1;
      background: rgba(0,0,0,.20);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 16px;
      overflow:hidden;
      min-height:0;
      position:relative;
    }
    canvas{ width:100%; height:100%; display:block; background: #0b0d18; }
    .hint{
      position:absolute; left:12px; bottom:12px;
      background: rgba(0,0,0,.55);
      border:1px solid rgba(255,255,255,.18);
      padding: 8px 12px;
      border-radius: 999px;
      font-size:12px;
      color: var(--text);
      pointer-events:none;
    }
    @media (max-width: 420px){
      input[type="range"]{ width: 110px; }
      .swatch{ width:34px; height:34px; border-radius:13px; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title">
        <div class="logo">üé®</div>
        <div style="min-width:0">
          <h1>Boyama</h1>
          <div class="sub">Parmaƒüƒ±nla √ßiz ve boya</div>
        </div>
      </div>
      <div class="actions">
        <button class="btn secondary" id="btnBack" type="button">‚¨ÖÔ∏è Men√º</button>
        <button class="btn secondary" id="btnEraser" type="button" aria-pressed="false">üßΩ Silgi</button>
        <button class="btn secondary" id="btnClear" type="button">üßº Temizle</button>
        <button class="btn" id="btnSave" type="button">üíæ Kaydet</button>
      </div>
    </header>

    <main>
      <section class="panel" aria-label="Boyama alanƒ±">
        <div class="toolbar">
          <div class="group">
            <div class="swatches" id="swatches" aria-label="Renk se√ßimi"></div>
          </div>

          <div class="group">
            <div class="slider" title="Fƒ±r√ßa kalƒ±nlƒ±ƒüƒ±">
              ‚úèÔ∏è Kalƒ±nlƒ±k
              <input id="brush" type="range" min="4" max="36" value="14" />
              <span id="brushVal">14</span>
            </div>
          </div>
        </div>

        <div class="canvasWrap">
          <canvas id="c"></canvas>
          <div class="hint">ƒ∞pucu: √áizmek i√ßin basƒ±lƒ± tutup s√ºr√ºkle üôÇ</div>
        </div>
      </section>
    </main>
  </div>

  <script>
    const btnBack = document.getElementById('btnBack');
    btnBack.addEventListener('click', () => window.location.href = "../../index.html");

    const canvas = document.getElementById('c');
    const ctx = canvas.getContext('2d');

    const swatchesEl = document.getElementById('swatches');
    const brushEl = document.getElementById('brush');
    const brushValEl = document.getElementById('brushVal');

    const btnEraser = document.getElementById('btnEraser');
    const btnClear = document.getElementById('btnClear');
    const btnSave = document.getElementById('btnSave');

    const COLORS = ["#ff4757","#ffa502","#ffd32a","#2ed573","#1e90ff","#3742fa","#a55eea","#ffffff","#2f3542"];
    let color = COLORS[0];
    let eraser = false;
    let drawing = false;
    let last = null;

    function resizeCanvas(){
      const rect = canvas.getBoundingClientRect();
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      canvas.width = Math.floor(rect.width * dpr);
      canvas.height = Math.floor(rect.height * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0); // drawing in CSS pixels
      // background
      ctx.fillStyle = "#0b0d18";
      ctx.fillRect(0,0,rect.width,rect.height);
      // guide: a soft frame
      ctx.strokeStyle = "rgba(255,255,255,.08)";
      ctx.lineWidth = 6;
      ctx.strokeRect(10,10,rect.width-20,rect.height-20);
      last = null;
    }

    function renderSwatches(){
      swatchesEl.innerHTML = "";
      for(const c of COLORS){
        const b = document.createElement('button');
        b.className = "swatch";
        b.type = "button";
        b.style.background = c;
        b.setAttribute("aria-pressed", String(c === color));
        b.addEventListener('click', () => {
          color = c;
          eraser = false;
          btnEraser.setAttribute("aria-pressed","false");
          renderSwatches();
        }, {passive:true});
        swatchesEl.appendChild(b);
      }
    }

    function getPoint(e){
      const rect = canvas.getBoundingClientRect();
      const t = (e.touches && e.touches[0]) ? e.touches[0] : e;
      return { x: t.clientX - rect.left, y: t.clientY - rect.top };
    }

    function strokeLine(a,b){
      ctx.lineCap = "round";
      ctx.lineJoin = "round";
      ctx.lineWidth = Number(brushEl.value);

      if(eraser){
        ctx.globalCompositeOperation = "destination-out";
        ctx.strokeStyle = "rgba(0,0,0,1)";
      }else{
        ctx.globalCompositeOperation = "source-over";
        ctx.strokeStyle = color;
      }

      ctx.beginPath();
      ctx.moveTo(a.x,a.y);
      ctx.lineTo(b.x,b.y);
      ctx.stroke();
    }

    function onDown(e){
      drawing = true;
      last = getPoint(e);
      e.preventDefault();
    }
    function onMove(e){
      if(!drawing) return;
      const p = getPoint(e);
      strokeLine(last, p);
      last = p;
      e.preventDefault();
    }
    function onUp(){
      drawing = false;
      last = null;
    }

    brushEl.addEventListener('input', () => brushValEl.textContent = brushEl.value);

    btnEraser.addEventListener('click', () => {
      eraser = !eraser;
      btnEraser.setAttribute("aria-pressed", String(eraser));
    });

    btnClear.addEventListener('click', () => {
      const rect = canvas.getBoundingClientRect();
      ctx.globalCompositeOperation = "source-over";
      ctx.fillStyle = "#0b0d18";
      ctx.fillRect(0,0,rect.width,rect.height);
      ctx.strokeStyle = "rgba(255,255,255,.08)";
      ctx.lineWidth = 6;
      ctx.strokeRect(10,10,rect.width-20,rect.height-20);
    });

    btnSave.addEventListener('click', () => {
      // Download PNG
      const a = document.createElement('a');
      a.download = "boyama.png";
      a.href = canvas.toDataURL("image/png");
      a.click();
    });

    canvas.addEventListener('mousedown', onDown);
    window.addEventListener('mousemove', onMove);
    window.addEventListener('mouseup', onUp);

    canvas.addEventListener('touchstart', onDown, {passive:false});
    canvas.addEventListener('touchmove', onMove, {passive:false});
    canvas.addEventListener('touchend', onUp);

    window.addEventListener('resize', resizeCanvas);

    renderSwatches();
    // first layout needs a tick
    requestAnimationFrame(resizeCanvas);
  </script>
</body>
</html>
