<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#111111" />
  <title>Meyveleri Sepete Koy</title>
  <style>
    :root{
      --bg:#0f1220; --panel:#171a2b; --text:#f2f5ff; --muted:#aab3d6;
      --shadow: 0 10px 30px rgba(0,0,0,.35); --radius:18px;
      --good:#35d07f; --bad:#ff5b6b;
    }
    *{box-sizing:border-box;}
    html,body{height:100%;}
    body{
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 900px at 20% 10%, #1a1f43 0%, var(--bg) 55%, #0b0d18 100%);
      color:var(--text);
      overflow:hidden;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    .app{height:100%; display:flex; flex-direction:column; padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);}
    header{
      padding:14px; display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .title{display:flex; align-items:center; gap:10px; min-width:0;}
    .logo{
      width:42px;height:42px;border-radius:14px;
      background: linear-gradient(135deg, #ffcc66, #ff6bd6 45%, #6b8bff);
      box-shadow: var(--shadow);
      display:grid; place-items:center; font-size:22px;
    }
    h1{margin:0; font-size:16px;}
    .sub{margin:2px 0 0; color:var(--muted); font-size:12px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
    .actions{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end; align-items:center;}
    .pill{
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      color:var(--text);
      border-radius:999px;
      padding:10px 12px;
      font-size:13px;
      display:flex;
      align-items:center;
      gap:8px;
      user-select:none;
      box-shadow: 0 10px 20px rgba(0,0,0,.15);
      font-weight:800;
    }
    .btn{
      appearance:none; border:0; cursor:pointer;
      border-radius:999px; padding:10px 14px;
      font-weight:800; font-size:13px; color:var(--text);
      background: linear-gradient(135deg, #6b8bff, #42e2ff);
      box-shadow: var(--shadow);
      user-select:none;
    }
    .btn.secondary{background: rgba(255,255,255,.10); border:1px solid rgba(255,255,255,.16);}
    .btn:active{transform: translateY(1px) scale(.99);}

    main{flex:1; padding: 0 14px 14px; min-height:0; display:flex;}
    .panel{
      width:100%; max-width:980px; margin:0 auto;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 12px;
      display:flex;
      flex-direction:column;
      gap:12px;
      min-height:0;
    }

    .bins{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap:12px;
    }
    .bin{
      border-radius: 18px;
      border: 2px dashed rgba(255,255,255,.20);
      background: rgba(255,255,255,.06);
      padding: 12px;
      min-height: 120px;
      display:flex;
      flex-direction:column;
      gap:8px;
      align-items:center;
      justify-content:center;
      position:relative;
    }
    .bin strong{font-size:13px;}
    .bin .icon{font-size:34px; filter: drop-shadow(0 10px 10px rgba(0,0,0,.25));}
    .bin.active{ border-color: rgba(66,226,255,.55); background: rgba(66,226,255,.10); }
    .bin.good{ border-color: rgba(53,208,127,.55); }
    .bin.bad{ border-color: rgba(255,91,107,.55); }

    .tray{
      flex:1;
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      align-content:flex-start;
      justify-content:center;
      padding: 6px;
      overflow:auto;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
    }
    .fruit{
      width:86px; height:86px;
      border-radius: 22px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.14);
      display:grid;
      place-items:center;
      font-size:40px;
      box-shadow: 0 12px 22px rgba(0,0,0,.25);
      user-select:none;
      touch-action:none; /* s√ºr√ºklemede scroll olmasƒ±n */
      cursor:grab;
      position:relative;
    }
    .fruit:active{ cursor:grabbing; transform: translateY(1px); }
    .fruit.done{
      opacity:.45;
      filter: grayscale(.6);
      pointer-events:none;
    }
    .toast{
      position:fixed;
      left:50%;
      bottom: calc(18px + env(safe-area-inset-bottom));
      transform: translateX(-50%);
      background: rgba(0,0,0,.6);
      border:1px solid rgba(255,255,255,.18);
      color: var(--text);
      padding: 10px 14px;
      border-radius: 999px;
      font-weight:800;
      font-size:13px;
      box-shadow: var(--shadow);
      opacity:0;
      pointer-events:none;
      transition: opacity .25s ease, transform .25s ease;
      max-width: calc(100% - 24px);
      text-align:center;
    }
    .toast.show{ opacity:1; transform: translateX(-50%) translateY(-6px); }

    @media (max-width: 420px){
      .fruit{ width:76px; height:76px; font-size:36px; border-radius:20px; }
      .bins{ gap:10px; }
      .bin{ min-height: 108px; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title">
        <div class="logo">üçì</div>
        <div style="min-width:0">
          <h1>Meyveleri Sepete Koy</h1>
          <div class="sub">Meyveyi s√ºr√ºkle ‚Üí doƒüru sepete bƒ±rak</div>
        </div>
      </div>
      <div class="actions">
        <button class="btn secondary" id="btnBack" type="button">‚¨ÖÔ∏è Men√º</button>
        <div class="pill">‚≠ê Puan: <span id="score">0</span></div>
        <button class="btn" id="btnReset" type="button">üîÅ Yeni</button>
      </div>
    </header>

    <main>
      <section class="panel" aria-label="S√ºr√ºkle bƒ±rak oyunu">
        <div class="bins">
          <div class="bin" data-type="red" aria-label="Kƒ±rmƒ±zƒ±lar sepeti">
            <div class="icon">üß∫</div>
            <strong>üçì Kƒ±rmƒ±zƒ±lar</strong>
            <div style="color:var(--muted);font-size:12px;">(√ßilek, kiraz)</div>
          </div>
          <div class="bin" data-type="yellow" aria-label="Sarƒ±lar sepeti">
            <div class="icon">üß∫</div>
            <strong>üçå Sarƒ±lar</strong>
            <div style="color:var(--muted);font-size:12px;">(muz, ananas)</div>
          </div>
          <div class="bin" data-type="green" aria-label="Ye≈üiller sepeti">
            <div class="icon">üß∫</div>
            <strong>üçè Ye≈üiller</strong>
            <div style="color:var(--muted);font-size:12px;">(elma, kivi)</div>
          </div>
        </div>

        <div class="tray" id="tray" aria-label="Meyveler"></div>
      </section>
    </main>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    const btnBack = document.getElementById('btnBack');
    btnBack.addEventListener('click', () => window.location.href = "../../index.html");

    const tray = document.getElementById('tray');
    const scoreEl = document.getElementById('score');
    const btnReset = document.getElementById('btnReset');
    const toastEl = document.getElementById('toast');
    const bins = [...document.querySelectorAll('.bin')];

    const FRUITS = [
      { emoji:"üçì", type:"red" },
      { emoji:"üçí", type:"red" },
      { emoji:"üçå", type:"yellow" },
      { emoji:"üçç", type:"yellow" },
      { emoji:"üçè", type:"green" },
      { emoji:"ü•ù", type:"green" },
      { emoji:"üçì", type:"red" },
      { emoji:"üçå", type:"yellow" },
      { emoji:"üçè", type:"green" }
    ];

    let score = 0;
    let dragging = null;
    let startPos = null;
    let offset = null;

    function showToast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add('show');
      clearTimeout(showToast._t);
      showToast._t = setTimeout(() => toastEl.classList.remove('show'), 1200);
    }

    function shuffle(arr){
      arr = [...arr];
      for(let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function resetGame(){
      score = 0;
      scoreEl.textContent = "0";
      tray.innerHTML = "";
      const list = shuffle(FRUITS).map((f, idx) => ({...f, id: idx}));

      for(const f of list){
        const el = document.createElement('div');
        el.className = "fruit";
        el.textContent = f.emoji;
        el.dataset.type = f.type;
        el.dataset.id = f.id;
        el.setAttribute('aria-label', 'Meyve');

        // pointer events for mouse+touch
        el.addEventListener('pointerdown', onDown);
        tray.appendChild(el);
      }
      showToast("Ba≈üla! Meyveyi s√ºr√ºkle üß∫");
    }

    function onDown(e){
      const el = e.currentTarget;
      if(el.classList.contains('done')) return;

      dragging = el;
      dragging.setPointerCapture(e.pointerId);

      const rect = dragging.getBoundingClientRect();
      startPos = { x: rect.left, y: rect.top };

      // offset inside the element
      offset = { x: e.clientX - rect.left, y: e.clientY - rect.top };

      // bring to top and detach from flow (overlay effect)
      dragging.style.position = "fixed";
      dragging.style.left = rect.left + "px";
      dragging.style.top = rect.top + "px";
      dragging.style.zIndex = "9999";
      dragging.style.width = rect.width + "px";
      dragging.style.height = rect.height + "px";

      document.addEventListener('pointermove', onMove, {passive:false});
      document.addEventListener('pointerup', onUp, {passive:false});

      bins.forEach(b => b.classList.add('active'));
      e.preventDefault();
    }

    function onMove(e){
      if(!dragging) return;
      const x = e.clientX - offset.x;
      const y = e.clientY - offset.y;
      dragging.style.left = x + "px";
      dragging.style.top = y + "px";
      e.preventDefault();
    }

    function markBin(bin, cls){
      bin.classList.remove('good','bad');
      bin.classList.add(cls);
      setTimeout(()=>bin.classList.remove('good','bad'), 450);
    }

    function onUp(e){
      if(!dragging) return;

      document.removeEventListener('pointermove', onMove);
      document.removeEventListener('pointerup', onUp);

      bins.forEach(b => b.classList.remove('active'));

      // check drop target
      const dropX = e.clientX;
      const dropY = e.clientY;

      let hit = null;
      for(const b of bins){
        const r = b.getBoundingClientRect();
        if(dropX >= r.left && dropX <= r.right && dropY >= r.top && dropY <= r.bottom){
          hit = b;
          break;
        }
      }

      if(hit){
        const need = hit.dataset.type;
        const got = dragging.dataset.type;

        if(need === got){
          // Correct
          score += 10;
          scoreEl.textContent = String(score);
          showToast("‚úÖ Doƒüru!");
          markBin(hit, 'good');

          dragging.classList.add('done');
          // snap into tray area (remove fixed)
          dragging.style.position = "";
          dragging.style.left = "";
          dragging.style.top = "";
          dragging.style.zIndex = "";
          dragging.style.width = "";
          dragging.style.height = "";

          // put back into tray but disabled
          tray.appendChild(dragging);

          checkWin();
        }else{
          // Wrong
          showToast("‚ùå Yanlƒ±≈ü sepet");
          markBin(hit, 'bad');
          returnToTray();
        }
      }else{
        returnToTray();
      }

      dragging = null;
      startPos = null;
      offset = null;
      e.preventDefault();
    }

    function returnToTray(){
      // animate back
      const el = dragging;
      el.style.transition = "left .18s ease, top .18s ease";
      el.style.left = startPos.x + "px";
      el.style.top = startPos.y + "px";
      setTimeout(() => {
        el.style.transition = "";
        el.style.position = "";
        el.style.left = "";
        el.style.top = "";
        el.style.zIndex = "";
        el.style.width = "";
        el.style.height = "";
        tray.appendChild(el);
      }, 190);
    }

    function checkWin(){
      const remaining = tray.querySelectorAll('.fruit:not(.done)').length;
      if(remaining === 0){
        showToast("üéâ Hepsi tamam!");
      }
    }

    btnReset.addEventListener('click', resetGame);
    resetGame();
  </script>
</body>
</html>
